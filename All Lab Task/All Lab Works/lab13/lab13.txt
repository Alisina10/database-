postgres=# -- Total students
SELECT COUNT(*) AS total_students FROM students;

-- Students with emails
SELECT COUNT(email) AS with_email FROM students;

-- Unique first names
SELECT COUNT(DISTINCT first_name) AS unique_first_names FROM students;
 total_students 
----------------
              2
(1 row)

 with_email 
------------
          2
(1 row)

 unique_first_names 
--------------------
                  2
(1 row)

postgres=# -- Total credits earned
SELECT SUM(credits) AS total_credits FROM students;

-- Average age
SELECT AVG(age) AS avg_age FROM students;
ERROR:  column "credits" does not exist
LINE 1: SELECT SUM(credits) AS total_credits FROM students;
                   ^
ERROR:  column "age" does not exist
LINE 1: SELECT AVG(age) AS avg_age FROM students;
                   ^
postgres=# SELECT 
    MAX(birth_date) AS youngest,
    MIN(birth_date) AS oldest
FROM students;
ERROR:  column "birth_date" does not exist
LINE 2:     MAX(birth_date) AS youngest,
                ^
postgres=# -- Average age by program
SELECT program, AVG(age) AS avg_age
FROM students
GROUP BY program;
ERROR:  column "program" does not exist
LINE 1: SELECT program, AVG(age) AS avg_age
               ^
postgres=# -- Only programs with > 3 students
SELECT program, COUNT(*) AS student_count
FROM students
GROUP BY program
HAVING COUNT(*) > 3;
ERROR:  column "program" does not exist
LINE 1: SELECT program, COUNT(*) AS student_count
               ^
postgres=# -- List of student names per program
SELECT program, STRING_AGG(first_name || ' ' || last_name, ', ') AS student_list
FROM students
GROUP BY program;

-- Same but as array
SELECT program, ARRAY_AGG(first_name) AS names_array
FROM students
GROUP BY program;
ERROR:  column "program" does not exist
LINE 1: SELECT program, STRING_AGG(first_name || ' ' || last_name, '...
               ^                            ^
postgres=# -- % of students in each program
SELECT 
    program,
    COUNT(*) AS count,
    ROUND(COUNT(*)::decimal / (SELECT COUNT(*) FROM students) * 100, 2) AS percentage
FROM students
GROUP BY program
ORDER BY percentage DESC;
     program      | count | percentage 
------------------+-------+------------
 Computer Science |     1 |      50.00
 Mathematics      |     1 |      50.00
(2 rows)

postgres=# ALTER TABLE students ADD COLUMN age INT;

UPDATE students SET age = 20 WHERE student_id = 1;
UPDATE students SET age = 21 WHERE student_id = 2;
ALTER TABLE
UPDATE 1
UPDATE 1
postgres=# ALTER TABLE students ADD COLUMN birth_date DATE;

UPDATE students SET birth_date = '2002-01-01' WHERE student_id = 1;
UPDATE students SET birth_date = '2001-05-20' WHERE student_id = 2;
ALTER TABLE
UPDATE 1
UPDATE 1
postgres=# ALTER TABLE students ADD COLUMN gender VARCHAR(10);
UPDATE students SET gender = 'Female' WHERE student_id = 1;
UPDATE students SET gender = 'Male' WHERE student_id = 2;
ALTER TABLE
UPDATE 1
UPDATE 1
postgres=# ALTER TABLE students ADD COLUMN grade INT;
UPDATE students SET grade = 92 WHERE student_id = 1;
UPDATE students SET grade = 85 WHERE student_id = 2;
ALTER TABLE
UPDATE 1
UPDATE 1
postgres=# SELECT 
    program,
    STDDEV(age) AS std_dev,
    VARIANCE(age) AS variance
FROM students
GROUP BY program;
     program      | std_dev | variance 
------------------+---------+----------
 Computer Science |         |         
 Mathematics      |         |         
(2 rows)

postgres=# SELECT program, gender, AVG(age) AS avg_age
FROM students
GROUP BY program, gender;
     program      | gender |       avg_age       
------------------+--------+---------------------
 Computer Science | Female | 20.0000000000000000
 Mathematics      | Male   | 21.0000000000000000
(2 rows)

postgres=# SELECT 
    program,
    COUNT(*) AS total_students,
    COUNT(CASE WHEN grade >= 90 THEN 1 END) AS top_students
FROM students
GROUP BY program;
     program      | total_students | top_students 
------------------+----------------+--------------
 Computer Science |              1 |            1
 Mathematics      |              1 |            0
(2 rows)

postgres=# SELECT program, COUNT(*) AS student_count
FROM students
GROUP BY program
HAVING COUNT(*) > 0;
     program      | student_count 
------------------+---------------
 Computer Science |             1
 Mathematics      |             1
(2 rows)

postgres=# 
